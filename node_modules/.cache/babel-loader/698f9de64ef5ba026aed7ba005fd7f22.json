{"ast":null,"code":"import _regeneratorRuntime from\"/Users/BobbyZheng/Desktop/INFO_253/Final_project/my_frontend_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/BobbyZheng/Desktop/INFO_253/Final_project/my_frontend_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/BobbyZheng/Desktop/INFO_253/Final_project/my_frontend_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useState}from'react';import pokeball from'../images/pokeball.png';import ModAvatar from'./ModAvatar';import axios from\"axios\";import*as mi from'@magenta/image';import{renderToStaticMarkup}from'react-dom/server';import canvasToImage from'canvas-to-image';var POKE_API_URL=\"https://pokeapi.co/api/v2/pokemon/\";function getRandomInt(max){return Math.floor(Math.random()*Math.floor(max))+1;}function PokeStyleFusion(props){var model=new mi.ArbitraryStyleTransferNetwork();var currentAva=props.currentAva;var contentImgSrc=encodeURIComponent(renderToStaticMarkup(/*#__PURE__*/_jsx(ModAvatar,{avaDetails:currentAva})));var dataUri=\"data:image/svg+xml,\".concat(contentImgSrc);//console.log(dataUri);\nvar _useState=useState(\"-\"),_useState2=_slicedToArray(_useState,2),pokeName=_useState2[0],setpokeName=_useState2[1];var _useState3=useState(\"-\"),_useState4=_slicedToArray(_useState3,2),pokeType=_useState4[0],setpokeType=_useState4[1];var _useState5=useState(pokeball),_useState6=_slicedToArray(_useState5,2),pokeImageUri=_useState6[0],setpokeImageUri=_useState6[1];var _useState7=useState(pokeball),_useState8=_slicedToArray(_useState7,2),pokeImageDisplayUri=_useState8[0],setPokeImageDisplayUri=_useState8[1];function fetchPokemon(){var fetchingURL=POKE_API_URL+getRandomInt(150);DataPromise(fetchingURL);};function saveCanvas(){var canvasEl=document.getElementById('stylized');canvasToImage(canvasEl,{name:'myAvaImage',type:'jpg',quality:1});}// function to get pokemon type\nfunction getPokemonType(typeList){var pokeType=\"\";for(var i=0;i<typeList.length;i++){// get the value of the key \"type\", which is another object\nvar typeObject=typeList[i][\"type\"];// then get the value of the key \"name\" which will be the pokemon type\nvar typeStr=typeObject[\"name\"];// add the type into pokeType\nif(i>0){pokeType=pokeType+\", \"+typeStr;}else{pokeType=pokeType+\" \"+typeStr;}}return pokeType;}function DataPromise(apiUrl){axios.get(apiUrl).then(function(response){var pokemonData=response.data;var pokemonName=pokemonData['name'];var pokemonimageURI=pokemonData['sprites']['other']['official-artwork']['front_default'];var pokeType=getPokemonType(pokemonData['types']);console.log(pokemonData);setpokeName(pokemonName);setpokeType(pokeType);setpokeImageUri(pokemonimageURI);}).catch(function(error){console.log(error);});}function stylization(){model.initialize().then(function(){stylize();});}function meetPoke(){setPokeImageDisplayUri(pokeImageUri);}function stylize(){return _stylize.apply(this,arguments);}function _stylize(){_stylize=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var contentImg,styleImg,canvas,ctx;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// await clearCanvas();\n// const contentCanvas = document.getElementById('styledAva').childNodes[0].childNodes[0];\ncontentImg=document.getElementById('content');styleImg=document.getElementById('style');canvas=document.getElementById('stylized');ctx=canvas.getContext('2d');// Resize the canvas to be the same size as the source image.\ncanvas.width=contentImg.width;canvas.height=contentImg.height;// This does all the work!\nmodel.stylize(contentImg,styleImg).then(function(imageData){ctx.putImageData(imageData,0,0);});case 7:case\"end\":return _context.stop();}}},_callee);}));return _stylize.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{id:\"select_pokemon\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"h3\",{id:\"pokeName\",children:\" Pokemon name: \"}),/*#__PURE__*/_jsxs(\"p\",{id:\"pokeName\",children:[\" \",pokeName,\" \"]})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"h3\",{id:\"pokeName\",children:\" Pokemon type: \"}),/*#__PURE__*/_jsxs(\"p\",{id:\"pokeType\",children:[\" \",pokeType,\" \"]})]})]}),/*#__PURE__*/_jsx(\"div\",{class:\"col-12-text-center\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",class:\"btn btn-primary btn-lg\",onClick:fetchPokemon,children:\"Fetch Random Pokemon\"})}),/*#__PURE__*/_jsx(\"h2\",{className:\"Instructions\",children:\" Step 4: Meet Your New Pokemon! \"}),/*#__PURE__*/_jsx(\"img\",{id:\"content\",height:\"256\",src:dataUri}),/*#__PURE__*/_jsx(\"img\",{id:\"style\",src:pokeImageDisplayUri,height:\"200\",width:\"200\",crossorigin:\"anonymous\"}),/*#__PURE__*/_jsx(\"div\",{class:\"col-12-text-center\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",class:\"btn btn-primary btn-lg\",onClick:meetPoke,children:\"Meet Pokemon \"})}),/*#__PURE__*/_jsx(\"h2\",{className:\"Instructions\",children:\" Step 5: Experimental Merge \"}),/*#__PURE__*/_jsx(\"canvas\",{id:\"stylized\",height:\"30\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{class:\"col-12-text-center\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",class:\"btn btn-primary btn-lg\",onClick:stylization,children:\"Transform!\"})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",class:\"btn btn-primary btn-lg\",onClick:saveCanvas,children:\"Save My Transformed Avatar\"})]});}export default PokeStyleFusion;","map":{"version":3,"sources":["/Users/BobbyZheng/Desktop/INFO_253/Final_project/my_frontend_project/src/components/PokeStyleFusion.js"],"names":["React","useState","pokeball","ModAvatar","axios","mi","renderToStaticMarkup","canvasToImage","POKE_API_URL","getRandomInt","max","Math","floor","random","PokeStyleFusion","props","model","ArbitraryStyleTransferNetwork","currentAva","contentImgSrc","encodeURIComponent","dataUri","pokeName","setpokeName","pokeType","setpokeType","pokeImageUri","setpokeImageUri","pokeImageDisplayUri","setPokeImageDisplayUri","fetchPokemon","fetchingURL","DataPromise","saveCanvas","canvasEl","document","getElementById","name","type","quality","getPokemonType","typeList","i","length","typeObject","typeStr","apiUrl","get","then","response","pokemonData","data","pokemonName","pokemonimageURI","console","log","catch","error","stylization","initialize","stylize","meetPoke","contentImg","styleImg","canvas","ctx","getContext","width","height","imageData","putImageData"],"mappings":"soBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CAEA,MAAOC,CAAAA,QAAP,KAAqB,wBAArB,CAEA,MAAOC,CAAAA,SAAP,KAAsB,aAAtB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAO,GAAKC,CAAAA,EAAZ,KAAoB,gBAApB,CACA,OAASC,oBAAT,KAAqC,kBAArC,CACA,MAAOC,CAAAA,aAAP,KAA0B,iBAA1B,CAGA,GAAMC,CAAAA,YAAY,CAAG,oCAArB,CAEA,QAASC,CAAAA,YAAT,CAAsBC,GAAtB,CAA2B,CACvB,MAAOC,CAAAA,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,GAAgBF,IAAI,CAACC,KAAL,CAAWF,GAAX,CAA3B,EAA8C,CAArD,CACH,CAED,QAASI,CAAAA,eAAT,CAAyBC,KAAzB,CAAgC,CAE5B,GAAMC,CAAAA,KAAK,CAAG,GAAIX,CAAAA,EAAE,CAACY,6BAAP,EAAd,CACA,GAAIC,CAAAA,UAAU,CAAGH,KAAK,CAACG,UAAvB,CAEA,GAAIC,CAAAA,aAAa,CAAGC,kBAAkB,CAACd,oBAAoB,cAAC,KAAC,SAAD,EAAW,UAAU,CAAEY,UAAvB,EAAD,CAArB,CAAtC,CACA,GAAIG,CAAAA,OAAO,8BAAyBF,aAAzB,CAAX,CAEA;AAR4B,cAUIlB,QAAQ,CAAC,GAAD,CAVZ,wCAUrBqB,QAVqB,eAUXC,WAVW,8BAWItB,QAAQ,CAAC,GAAD,CAXZ,yCAWrBuB,QAXqB,eAWXC,WAXW,8BAYYxB,QAAQ,CAACC,QAAD,CAZpB,yCAYrBwB,YAZqB,eAYPC,eAZO,8BAa0B1B,QAAQ,CAACC,QAAD,CAblC,yCAarB0B,mBAbqB,eAaAC,sBAbA,eAe5B,QAASC,CAAAA,YAAT,EAAwB,CACpB,GAAMC,CAAAA,WAAW,CAAGvB,YAAY,CAAGC,YAAY,CAAC,GAAD,CAA/C,CACAuB,WAAW,CAACD,WAAD,CAAX,CACH,EAGD,QAASE,CAAAA,UAAT,EAAqB,CACjB,GAAMC,CAAAA,QAAQ,CAAGC,QAAQ,CAACC,cAAT,CAAwB,UAAxB,CAAjB,CACA7B,aAAa,CAAC2B,QAAD,CAAW,CACpBG,IAAI,CAAE,YADc,CAEpBC,IAAI,CAAE,KAFc,CAGpBC,OAAO,CAAE,CAHW,CAAX,CAAb,CAKH,CACD;AACA,QAASC,CAAAA,cAAT,CAAwBC,QAAxB,CAAkC,CAC9B,GAAIjB,CAAAA,QAAQ,CAAG,EAAf,CAEA,IAAK,GAAIkB,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGD,QAAQ,CAACE,MAA7B,CAAqCD,CAAC,EAAtC,CAA0C,CACtC;AACA,GAAIE,CAAAA,UAAU,CAAGH,QAAQ,CAACC,CAAD,CAAR,CAAY,MAAZ,CAAjB,CACA;AACA,GAAIG,CAAAA,OAAO,CAAGD,UAAU,CAAC,MAAD,CAAxB,CACA;AACA,GAAIF,CAAC,CAAG,CAAR,CAAW,CACPlB,QAAQ,CAAGA,QAAQ,CAAG,IAAX,CAAkBqB,OAA7B,CACH,CAFD,IAGK,CACDrB,QAAQ,CAAGA,QAAQ,CAAG,GAAX,CAAiBqB,OAA5B,CACH,CACJ,CAED,MAAOrB,CAAAA,QAAP,CACH,CAED,QAASQ,CAAAA,WAAT,CAAqBc,MAArB,CAA6B,CACzB1C,KAAK,CAAC2C,GAAN,CAAUD,MAAV,EAAkBE,IAAlB,CAAuB,SAACC,QAAD,CAAc,CACjC,GAAMC,CAAAA,WAAW,CAAGD,QAAQ,CAACE,IAA7B,CACA,GAAMC,CAAAA,WAAW,CAAGF,WAAW,CAAC,MAAD,CAA/B,CACA,GAAMG,CAAAA,eAAe,CAAGH,WAAW,CAAC,SAAD,CAAX,CAAuB,OAAvB,EAAgC,kBAAhC,EAAoD,eAApD,CAAxB,CACA,GAAM1B,CAAAA,QAAQ,CAAGgB,cAAc,CAACU,WAAW,CAAC,OAAD,CAAZ,CAA/B,CACAI,OAAO,CAACC,GAAR,CAAYL,WAAZ,EACA3B,WAAW,CAAC6B,WAAD,CAAX,CACA3B,WAAW,CAACD,QAAD,CAAX,CACAG,eAAe,CAAC0B,eAAD,CAAf,CACH,CATD,EASGG,KATH,CASS,SAACC,KAAD,CAAW,CAChBH,OAAO,CAACC,GAAR,CAAYE,KAAZ,EACH,CAXD,EAYH,CAGD,QAASC,CAAAA,WAAT,EAAuB,CACnB1C,KAAK,CAAC2C,UAAN,GAAmBX,IAAnB,CAAwB,UAAM,CAC1BY,OAAO,GACV,CAFD,EAIH,CAED,QAASC,CAAAA,QAAT,EAAmB,CACfhC,sBAAsB,CAACH,YAAD,CAAtB,CACH,CA3E2B,QA6EbkC,CAAAA,OA7Ea,+HA6E5B,sKACI;AAEA;AACME,UAJV,CAIuB3B,QAAQ,CAACC,cAAT,CAAwB,SAAxB,CAJvB,CAKU2B,QALV,CAKqB5B,QAAQ,CAACC,cAAT,CAAwB,OAAxB,CALrB,CAMU4B,MANV,CAMmB7B,QAAQ,CAACC,cAAT,CAAwB,UAAxB,CANnB,CAOU6B,GAPV,CAOgBD,MAAM,CAACE,UAAP,CAAkB,IAAlB,CAPhB,CASI;AACAF,MAAM,CAACG,KAAP,CAAeL,UAAU,CAACK,KAA1B,CACAH,MAAM,CAACI,MAAP,CAAgBN,UAAU,CAACM,MAA3B,CAEA;AACApD,KAAK,CAAC4C,OAAN,CAAcE,UAAd,CAA0BC,QAA1B,EAAoCf,IAApC,CAAyC,SAACqB,SAAD,CAAe,CACpDJ,GAAG,CAACK,YAAJ,CAAiBD,SAAjB,CAA4B,CAA5B,CAA+B,CAA/B,EACH,CAFD,EAdJ,sDA7E4B,0CAgG5B,mBACI,aAAK,EAAE,CAAC,gBAAR,wBAEA,aAAK,KAAK,CAAC,KAAX,wBAEI,aAAK,KAAK,CAAC,UAAX,wBACI,WAAI,EAAE,CAAC,UAAP,6BADJ,cAEI,WAAG,EAAE,CAAC,UAAN,eAAmB/C,QAAnB,OAFJ,GAFJ,cAOI,aAAK,KAAK,CAAC,UAAX,wBACI,WAAI,EAAE,CAAC,UAAP,6BADJ,cAEI,WAAG,EAAE,CAAC,UAAN,eAAmBE,QAAnB,OAFJ,GAPJ,GAFA,cAcA,YAAK,KAAK,CAAC,oBAAX,uBACI,eAAQ,IAAI,CAAC,QAAb,CAAsB,KAAK,CAAC,wBAA5B,CAAqD,OAAO,CAAEM,YAA9D,kCADJ,EAdA,cAoBI,WAAI,SAAS,CAAC,cAAd,8CApBJ,cAqBI,YAAK,EAAE,CAAC,SAAR,CAAkB,MAAM,CAAC,KAAzB,CAA+B,GAAG,CAAET,OAApC,EArBJ,cAsBI,YAAK,EAAE,CAAC,OAAR,CAAgB,GAAG,CAAEO,mBAArB,CAA0C,MAAM,CAAC,KAAjD,CAAuD,KAAK,CAAC,KAA7D,CAAmE,WAAW,CAAC,WAA/E,EAtBJ,cA0BI,YAAK,KAAK,CAAC,oBAAX,uBACA,eAAQ,IAAI,CAAC,QAAb,CAAsB,KAAK,CAAC,wBAA5B,CAAqD,OAAO,CAAEiC,QAA9D,2BADA,EA1BJ,cA+BI,WAAI,SAAS,CAAC,cAAd,0CA/BJ,cAgCI,eAAQ,EAAE,CAAC,UAAX,CAAsB,MAAM,CAAC,IAA7B,EAhCJ,cAkCI,aAlCJ,cAqCI,YAAK,KAAK,CAAC,oBAAX,uBACA,eAAQ,IAAI,CAAC,QAAb,CAAsB,KAAK,CAAC,wBAA5B,CAAqD,OAAO,CAAEH,WAA9D,wBADA,EArCJ,cAyCI,aAzCJ,cA2CI,eAAQ,IAAI,CAAC,QAAb,CAAsB,KAAK,CAAC,wBAA5B,CAAqD,OAAO,CAAEzB,UAA9D,wCA3CJ,GADJ,CAgDH,CAGD,cAAenB,CAAAA,eAAf","sourcesContent":["import React, { useState } from 'react';\n\nimport pokeball from '../images/pokeball.png';\n\nimport ModAvatar from './ModAvatar';\nimport axios from \"axios\";\nimport * as mi from '@magenta/image';\nimport { renderToStaticMarkup } from 'react-dom/server';\nimport canvasToImage from 'canvas-to-image';\n\n\nconst POKE_API_URL = \"https://pokeapi.co/api/v2/pokemon/\"\n\nfunction getRandomInt(max) {\n    return Math.floor(Math.random() * Math.floor(max)) + 1;\n}\n\nfunction PokeStyleFusion(props) {\n\n    const model = new mi.ArbitraryStyleTransferNetwork();\n    let currentAva = props.currentAva;\n\n    let contentImgSrc = encodeURIComponent(renderToStaticMarkup(<ModAvatar avaDetails={currentAva} />));\n    let dataUri = `data:image/svg+xml,${contentImgSrc}`;\n\n    //console.log(dataUri);\n\n    const [pokeName, setpokeName] = useState(\"-\")\n    const [pokeType, setpokeType] = useState(\"-\")\n    const [pokeImageUri, setpokeImageUri] = useState(pokeball)\n    const [pokeImageDisplayUri, setPokeImageDisplayUri] = useState(pokeball)\n\n    function fetchPokemon() {\n        const fetchingURL = POKE_API_URL + getRandomInt(150);\n        DataPromise(fetchingURL);\n    };\n    \n\n    function saveCanvas(){\n        const canvasEl = document.getElementById('stylized');\n        canvasToImage(canvasEl, {\n            name: 'myAvaImage',\n            type: 'jpg',\n            quality: 1\n          });\n    }\n    // function to get pokemon type\n    function getPokemonType(typeList) {\n        let pokeType = \"\";\n\n        for (let i = 0; i < typeList.length; i++) {\n            // get the value of the key \"type\", which is another object\n            let typeObject = typeList[i][\"type\"];\n            // then get the value of the key \"name\" which will be the pokemon type\n            let typeStr = typeObject[\"name\"];\n            // add the type into pokeType\n            if (i > 0) {\n                pokeType = pokeType + \", \" + typeStr;\n            }\n            else {\n                pokeType = pokeType + \" \" + typeStr;\n            }\n        }\n\n        return pokeType;\n    }\n\n    function DataPromise(apiUrl) {\n        axios.get(apiUrl).then((response) => {\n            const pokemonData = response.data;\n            const pokemonName = pokemonData['name'];\n            const pokemonimageURI = pokemonData['sprites']['other']['official-artwork']['front_default'];\n            const pokeType = getPokemonType(pokemonData['types']);\n            console.log(pokemonData);\n            setpokeName(pokemonName);\n            setpokeType(pokeType);\n            setpokeImageUri(pokemonimageURI);\n        }).catch((error) => {\n            console.log(error);\n        })\n    }\n\n\n    function stylization() {\n        model.initialize().then(() => {  \n            stylize();  \n        }  \n        );  \n    }\n\n    function meetPoke(){\n        setPokeImageDisplayUri(pokeImageUri); \n    }\n\n    async function stylize() {\n        // await clearCanvas();\n\n        // const contentCanvas = document.getElementById('styledAva').childNodes[0].childNodes[0];\n        const contentImg = document.getElementById('content')\n        const styleImg = document.getElementById('style');\n        const canvas = document.getElementById('stylized');\n        const ctx = canvas.getContext('2d');\n\n        // Resize the canvas to be the same size as the source image.\n        canvas.width = contentImg.width;\n        canvas.height = contentImg.height;\n\n        // This does all the work!\n        model.stylize(contentImg, styleImg).then((imageData) => {\n            ctx.putImageData(imageData, 0, 0);\n        });\n    }\n\n    return (\n        <div id='select_pokemon'>\n\n        <div class=\"row\">\n\n            <div class=\"col-md-6\">\n                <h3 id='pokeName'> Pokemon name: </h3>\n                <p id='pokeName'> {pokeName} </p>\n            </div>\n\n            <div class=\"col-md-6\">\n                <h3 id='pokeName'> Pokemon type: </h3>\n                <p id='pokeType'> {pokeType} </p>\n            </div>\n        </div>\n        <div class=\"col-12-text-center\">\n            <button type=\"button\" class=\"btn btn-primary btn-lg\" onClick={fetchPokemon}>\n                Fetch Random Pokemon\n            </button>\n        </div>\n\n            <h2 className=\"Instructions\"> Step 4: Meet Your New Pokemon! </h2>\n            <img id='content' height=\"256\" src={dataUri}></img>\n            <img id='style' src={pokeImageDisplayUri} height=\"200\" width=\"200\" crossorigin=\"anonymous\"></img>\n            {/* <canvas id='stylized' height=\"30\" >\n            </canvas> */}\n\n            <div class=\"col-12-text-center\">\n            <button type=\"button\" class=\"btn btn-primary btn-lg\" onClick={meetPoke}>Meet Pokemon </button> \n            </div>\n\n\n            <h2 className=\"Instructions\"> Step 5: Experimental Merge </h2>\n            <canvas id='stylized' height=\"30\" >\n            </canvas>\n            <br></br>\n\n            \n            <div class=\"col-12-text-center\">\n            <button type=\"button\" class=\"btn btn-primary btn-lg\" onClick={stylization}>Transform!</button>\n            </div>\n\n            <br></br>\n\n            <button type=\"button\" class=\"btn btn-primary btn-lg\" onClick={saveCanvas}>Save My Transformed Avatar</button>\n\n        </div>);\n   \n}\n\n\nexport default PokeStyleFusion;"]},"metadata":{},"sourceType":"module"}